<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Allison C Fialkowski" />

<meta name="date" content="2017-11-30" />

<title>Calculation of Correlation Boundaries</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Calculation of Correlation Boundaries</h1>
<h4 class="author"><em>Allison C Fialkowski</em></h4>
<h4 class="date"><em>2017-11-30</em></h4>



<p>There are two simulation pathways in <strong>SimCorrMix</strong> which differ primarily according to the calculation of the intermediate correlations involving count variables. Each pathway has its own function to calculate correlation boundaries, given specified distributional parameters, and to check if a target correlation matrix <code>rho</code> falls within these boundaries. Correlation method 1 uses <code>validcorr</code> and correlation method 2 uses <code>validcorr2</code>. The parameter inputs should be checked first using <code>validpar</code>. Some code has been modified from the <strong>SimMultiCorrData</strong> package <span class="citation">(Fialkowski 2017)</span>.</p>
<p>Some general methods for determining correlation boundaries:</p>
<div id="the-generate-sort-and-correlate-gsc-algorithm" class="section level3">
<h3>The Generate, Sort, and Correlate (GSC) Algorithm:</h3>
<p>The GSC algorithm is a flexible method for determining empirical correlation bounds when the theoretical bounds are unknown. The steps are as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Generate independent random samples from the desired distributions using a large number of observations (i.e. <span class="math inline">\(n = 100,000\)</span>).</p></li>
<li><p><strong>Lower Bound:</strong> Sort the two variables in opposite directions (i.e., one increasing and one decreasing) and find the sample correlation.</p></li>
<li><p><strong>Upper Bound:</strong> Sort the two variables in the same direction and find the sample correlation.</p></li>
</ol>
<p><span class="citation">Demirtas and Hedeker (2011)</span> showed that the empirical bounds computed from the GSC method are similar to the theoretical bounds (when they are known).</p>
</div>
<div id="the-frechet-hoeffding-correlation-bounds" class="section level3">
<h3>The Frechet-Hoeffding Correlation Bounds:</h3>
<p>Suppose two random variables <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> have cumulative distribution functions given by <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span>. Let <span class="math inline">\(U\)</span> be a Uniform(0,1) random variable, i.e. representing the distribution of the standard normal CDF. Then <span class="citation">Hoeffding (1994)</span> and <span class="citation">Fréchet (1957)</span> showed that bounds for the correlation between <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span> are given by: <span class="math display">\[\{cor(F_1^{-1}(U), F_2^{-1}(1 - U)),\ cor(F_1^{-1}(U), F_2^{-1}(U))\}.\]</span></p>
</div>
<div id="methods-used-in-both-pathways" class="section level3">
<h3>Methods Used in Both Pathways:</h3>
<p>First, the calculations which are equivalent in the two pathways will be discussed by variable type.</p>
<p><strong>Ordinal Variables:</strong></p>
<ol style="list-style-type: decimal">
<li><p><em>Binary pairs:</em> The correlation bounds are determined as in <span class="citation">Demirtas, Hedeker, and Mermelstein (2012)</span>, who used the method of <span class="citation">Emrich and Piedmonte (1991)</span>. The joint distribution is determined by “borrowing” the moments of a multivariate normal distribution. For two binary variables <span class="math inline">\(Y_1\)</span> and <span class="math inline">\(Y_2\)</span>, with success probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2\)</span>, the boundaries are given by: <span class="math display">\[\{max(-\sqrt{(p_1p_2)/(q_1q_2)},\ -\sqrt{(q_1q_2)/(p_1p_2)}),\ \ \ min(\sqrt{(p_1q_2)/(q_1p_2)},\ \sqrt{(q_1p_2)/(p_1q_2)})\},\]</span> where <span class="math inline">\(q_1 = 1 - p_1\)</span> and <span class="math inline">\(q_2 = 1 - p_2\)</span>.</p></li>
<li><p><em>Binary-Ordinal or Ordinal-Ordinal pairs:</em> Randomly generated variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p></li>
</ol>
<p><strong>Continuous Variables:</strong> Continuous variables are randomly generated using constants from <code>SimMultiCorrData::find_constants</code> and a vector of sixth cumulant correction values (if provided.) The GSC algorithm is used to find the lower and upper bounds.</p>
<p><strong>Continuous - Ordinal Pairs:</strong> Randomly generated ordinal variables with the given marginal distributions and the previously generated continuous variables are used in the GSC algorithm to find the correlation bounds.</p>
</div>
<div id="correlation-method-1" class="section level3">
<h3>Correlation Method 1:</h3>
<p>The distribution functions for Poisson and Negative Binomial variables are taken from the <strong>VGAM</strong> package <span class="citation">(Yee 2017)</span>.</p>
<p><strong>Poisson Variables:</strong> Poisson variables with the given means (<code>lam</code>) and probabilities of structural zeros (<code>p_zip</code> for zero-inflated Poisson) are randomly generated using the inverse CDF method. The Frechet-Hoeffding bounds are used for the correlation bounds.</p>
<p><strong>Negative Binomial Variables:</strong> Negative Binomial variables with the given sizes (<code>size</code>), success probabilities (<code>prob</code>) or means (<code>mu</code>), and probabilities of structural zeros (<code>p_zinb</code> for zero-inflated NB) are randomly generated using the inverse CDF method. The Frechet-Hoeffding bounds are used for the correlation bounds.</p>
<p><strong>Ordinal - Poisson Pairs:</strong> Randomly generated ordinal variables with the given marginal distributions and randomly generated Poisson variables with the given means (<code>lam</code>) and probabilities of structural zeros (<code>p_zip</code> for zero-inflated Poisson) are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Ordinal - Negative Binomial Pairs:</strong> Randomly generated ordinal variables with the given marginal distributions and randomly generated Negative Binomial variables with the given sizes (<code>size</code>), success probabilities (<code>prob</code>) or means (<code>mu</code>), and probabilities of structural zeros (<code>p_zinb</code> for zero-inflated NB) are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Continuous - Poisson Pairs:</strong> The previously generated continuous variables and randomly generated Poisson variables with the given means (<code>lam</code>) and probabilities of structural zeros (<code>p_zip</code> for zero-inflated Poisson) are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Continuous - Negative Binomial Pairs:</strong> The previously generated continuous variables and randomly generated Negative Binomial variables with the given sizes (<code>size</code>), success probabilities (<code>prob</code>) or means (<code>mu</code>), and probabilities of structural zeros (<code>p_zinb</code> for zero-inflated NB) are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Poisson - Negative Binomial Pairs:</strong> Poisson variables with the given means (<code>lam</code>) and probabilities of structural zeros (<code>p_zip</code> for zero-inflated Poisson) and Negative Binomial variables with the given sizes (<code>size</code>), success probabilities (<code>prob</code>) or means (<code>mu</code>), and probabilities of structural zeros (<code>p_zinb</code> for zero-inflated NB) are randomly generated using the inverse CDF method. The Frechet-Hoeffding bounds are used for the correlation bounds.</p>
</div>
<div id="correlation-method-2" class="section level3">
<h3>Correlation Method 2:</h3>
<p>In correlation method 2, count variables (regular or zero-inflated) are treated as “ordinal” by truncating their infinite supports. The maximum support values for the Poisson variables, given the cumulative probability truncation values (<code>pois_eps</code>), means (<code>lam</code>), and probabilities of structural zeros (<code>p_zip</code> for zero-inflated Poisson), are calculated using <code>maxcount_support</code>. The finite supports are used to determine marginal distributions for each Poisson variable. The maximum support values for the Negative Binomial variables, given the cumulative probability truncation values (<code>nb_eps</code>), sizes (<code>size</code>), success probabilities (<code>prob</code>) or means (<code>mu</code>), and probabilities of structural zeros (<code>p_zinb</code> for zero-inflated NB), are calculated using <code>maxcount_support</code>. The finite supports are used to determine marginal distributions for each NB variable.</p>
<p><strong>Poisson Variables:</strong> Randomly generated variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Negative Binomial Variables:</strong> Randomly generated variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Ordinal - Poisson Pairs:</strong> Randomly generated ordinal and Poisson variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Ordinal - Negative Binomial Pairs:</strong> Randomly generated ordinal and Negative Binomial variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Continuous - Poisson Pairs:</strong> The previously generated continuous variables and randomly generated Poisson variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Continuous - Negative Binomial Pairs:</strong> The previously generated continuous variables and randomly generated Negative Binomial variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
<p><strong>Poisson - Negative Binomial Pairs:</strong> Randomly generated variables with the given marginal distributions are used in the GSC algorithm to find the correlation bounds.</p>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<script type="text/x-mathjax-config">
   MathJax.Hub.Config({  "HTML-CSS": { minScaleAdjust: 115, availableFonts: [] }  });
</script>
<div id="refs" class="references">
<div id="ref-DemHed">
<p>Demirtas, H, and D Hedeker. 2011. “A Practical Way for Computing Approximate Lower and Upper Correlation Bounds.” <em>The American Statistician</em> 65 (2): 104–9. doi:<a href="https://doi.org/10.1198/tast.2011.10090">10.1198/tast.2011.10090</a>.</p>
</div>
<div id="ref-Dem_Power">
<p>Demirtas, H, D Hedeker, and R J Mermelstein. 2012. “Simulation of Massive Public Health Data by Power Polynomials.” <em>Statistics in Medicine</em> 31 (27): 3337–46. doi:<a href="https://doi.org/10.1002/sim.5362">10.1002/sim.5362</a>.</p>
</div>
<div id="ref-EmPied">
<p>Emrich, L J, and M R Piedmonte. 1991. “A Method for Generating High-Dimensional Multivariate Binary Variates.” <em>The American Statistician</em> 45: 302–4. doi:<a href="https://doi.org/10.1080/00031305.1991.10475828">10.1080/00031305.1991.10475828</a>.</p>
</div>
<div id="ref-SMCD">
<p>Fialkowski, A C. 2017. <em>SimMultiCorrData: Simulation of Correlated Data with Multiple Variable Types</em>. <a href="https://CRAN.R-project.org/package=SimMultiCorrData" class="uri">https://CRAN.R-project.org/package=SimMultiCorrData</a>.</p>
</div>
<div id="ref-Frech">
<p>Fréchet, M. 1957. “Les Tableaux de Corrélation et Les Programmes Linéaires.” <em>Revue de L’Institut International de Statistique / Review of the International Statistical Institute</em> 25 (1/3): 23–40. doi:<a href="https://doi.org/10.2307/1401672">10.2307/1401672</a>.</p>
</div>
<div id="ref-Hoeff">
<p>Hoeffding, W. 1994. “Scale-Invariant Correlation Theory.” In <em>The Collected Works of Wassily Hoeffding</em>, edited by N I Fisher and P K Sen, 57–107. Springer Series in Statistics (Perspectives in Statistics). New York: Springer-Verlag. doi:<a href="https://doi.org/10.1007/978-1-4612-0865-5_4">10.1007/978-1-4612-0865-5_4</a>.</p>
</div>
<div id="ref-VGAM">
<p>Yee, T W. 2017. <em>VGAM: Vector Generalized Linear and Additive Models</em>. <a href="https://CRAN.R-project.org/package=VGAM" class="uri">https://CRAN.R-project.org/package=VGAM</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
